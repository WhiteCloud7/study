"use strict";(self["webpackChunkblog"]=self["webpackChunkblog"]||[]).push([[788],{3788:function(e,l,a){a.r(l),a.d(l,{default:function(){return F}});a(4114);var u=a(6436),t=a(1469),o=a(7959),n=a(5167),v=a(5032),s=a(3229);const r={class:"edit-profile-content"},p={class:"profile-avatar"},i={class:"profile-item"},d={class:"profile-item"},c={class:"profile-item"},m={class:"profile-item"},k={class:"profile-item"},h={class:"profile-item"},f={class:"profile-item"},g={class:"button-group",style:{"margin-left":"160px"}};var b={__name:"profileSetting",setup(e){const l=(0,n.KR)(""),a=(0,n.KR)(""),b=(0,n.KR)(""),L=(0,n.KR)(""),V=(0,n.KR)(""),F=(0,n.KR)(""),K=(0,n.KR)(""),R=(0,n.KR)(""),y=(0,n.KR)(""),_=(0,n.KR)(""),w=(0,n.KR)(""),x=(0,n.KR)(""),U=(0,n.KR)(""),A=(0,n.KR)(""),C=(0,n.KR)(""),D=(0,n.KR)(""),q=(0,s.rd)();function Q(e){const l=new Date(e),a=new Date;let u=a.getFullYear()-l.getFullYear();const t=a.getMonth()-l.getMonth();return(t<0||0===t&&a.getDate()<l.getDate())&&u--,u}function S(){v.A.get("http://localhost:8081/profile",{responseType:"json"}).then((e=>{const u=e.data.data;l.value=u.avatar_src,a.value=u.nikeName,b.value=u.sex,V.value=u.birthday,F.value=u.phone,K.value=u.qq,R.value=u.wechat,y.value=u.school,L.value=Q(V.value),_.value=a.value,w.value=b.value,x.value=V.value,U.value=F.value,A.value=K.value,C.value=R.value,D.value=y.value})).catch((e=>{console.log(e)}))}function z(){v.A.post("http://localhost:8081/saveProfile",{nikeName:a.value,sex:b.value,birthday:null===V.value?null:V.value.toLocaleString(),phone:F.value,qq:K.value,wechat:R.value,school:y.value,avatar:l.value}).then((e=>{"昵称已被使用！"===e.data.data?alert("昵称已被使用！"):alert("资料保存成功")})).catch((e=>{console.log(e),alert("资料保存失败，请稍后重试")}))}function B(){a.value=_.value,b.value=w.value,V.value=x.value,F.value=U.value,K.value=A.value,R.value=C.value,y.value=D.value,q.push("/profile")}(0,u.sV)((()=>{S()})),(0,u.wB)(V,(e=>{e&&(L.value=Q(e))}));const M=e=>{"上传文件为空"===e.data?alert("上传文件为空!"):"上传失败"===e.data?alert("上传失败!"):(l.value=e.data.avatar_url,alert("头像上传成功!"))},N=e=>{const l="image/jpeg"===e.type||"image/png"===e.type;if(!l)return alert("只能上传 JPG/PNG 格式的图片"),!1;const a=e.size/1024/1024<2;return a?l&&a:(alert("图片大小不能超过 2MB"),!1)},P={Authorization:`Bearer ${sessionStorage.getItem("token")}`};return(e,n)=>{const v=(0,u.g2)("el-avatar"),s=(0,u.g2)("el-button"),_=(0,u.g2)("el-upload"),w=(0,u.g2)("el-input"),x=(0,u.g2)("el-option"),U=(0,u.g2)("el-select"),A=(0,u.g2)("el-date-picker");return(0,u.uX)(),(0,u.CE)("div",r,[n[20]||(n[20]=(0,u.Lk)("h1",null,"编辑资料",-1)),(0,u.Lk)("form",{onSubmit:(0,t.D$)(z,["prevent"])},[(0,u.Lk)("div",p,[n[9]||(n[9]=(0,u.Lk)("span",{style:{position:"relative",top:"8px"}},"头像:",-1)),(0,u.bF)(v,{src:l.value,size:"100",style:{"margin-left":"48px"}},null,8,["src"]),(0,u.bF)(_,{class:"avatar-uploader",action:"http://localhost:8081/api/uploadAvatar","show-file-list":!1,"on-success":M,headers:P,"before-upload":N},{default:(0,u.k6)((()=>[n[8]||(n[8]=(0,u.Lk)("i",{class:"el-icon-upload"},null,-1)),(0,u.bF)(s,{style:{"margin-left":"20px"}},{default:(0,u.k6)((()=>n[7]||(n[7]=[(0,u.eW)("点击上传")]))),_:1})])),_:1})]),(0,u.Lk)("div",i,[n[10]||(n[10]=(0,u.Lk)("span",null,"昵称:",-1)),(0,u.bF)(w,{modelValue:a.value,"onUpdate:modelValue":n[0]||(n[0]=e=>a.value=e),placeholder:"请输入昵称"},null,8,["modelValue"])]),(0,u.Lk)("div",d,[n[11]||(n[11]=(0,u.Lk)("span",null,"性别:",-1)),(0,u.bF)(U,{modelValue:b.value,"onUpdate:modelValue":n[1]||(n[1]=e=>b.value=e),placeholder:"请选择性别"},{default:(0,u.k6)((()=>[(0,u.bF)(x,{label:"男",value:"男"}),(0,u.bF)(x,{label:"女",value:"女"})])),_:1},8,["modelValue"])]),(0,u.Lk)("div",c,[n[12]||(n[12]=(0,u.Lk)("span",null,"生日:",-1)),(0,u.bF)(A,{modelValue:V.value,"onUpdate:modelValue":n[2]||(n[2]=e=>V.value=e),type:"date",placeholder:"选择生日"},null,8,["modelValue"]),n[13]||(n[13]=(0,u.Lk)("span",{style:{"margin-left":"10px"}},"年龄:",-1)),(0,u.Lk)("span",null,(0,o.v_)(L.value),1)]),(0,u.Lk)("div",m,[n[14]||(n[14]=(0,u.Lk)("span",null,"电话:",-1)),(0,u.bF)(w,{modelValue:F.value,"onUpdate:modelValue":n[3]||(n[3]=e=>F.value=e),placeholder:"请输入电话号码"},null,8,["modelValue"])]),(0,u.Lk)("div",k,[n[15]||(n[15]=(0,u.Lk)("span",null,"QQ:",-1)),(0,u.bF)(w,{modelValue:K.value,"onUpdate:modelValue":n[4]||(n[4]=e=>K.value=e),placeholder:"请输入 QQ 号"},null,8,["modelValue"])]),(0,u.Lk)("div",h,[n[16]||(n[16]=(0,u.Lk)("span",null,"微信:",-1)),(0,u.bF)(w,{modelValue:R.value,"onUpdate:modelValue":n[5]||(n[5]=e=>R.value=e),placeholder:"请输入微信号"},null,8,["modelValue"])]),(0,u.Lk)("div",f,[n[17]||(n[17]=(0,u.Lk)("span",null,"毕业院校:",-1)),(0,u.bF)(w,{modelValue:y.value,"onUpdate:modelValue":n[6]||(n[6]=e=>y.value=e),placeholder:"请输入毕业院校"},null,8,["modelValue"])]),(0,u.Lk)("div",g,[(0,u.bF)(s,{type:"primary",onClick:z,style:{"margin-right":"40px"}},{default:(0,u.k6)((()=>n[18]||(n[18]=[(0,u.eW)("保存")]))),_:1}),(0,u.bF)(s,{onClick:B},{default:(0,u.k6)((()=>n[19]||(n[19]=[(0,u.eW)("取消")]))),_:1})])],32)])}}},L=a(5932);const V=(0,L.A)(b,[["__scopeId","data-v-28a1972a"]]);var F=V}}]);
//# sourceMappingURL=788.a701ce88.js.map