{"version":3,"file":"js/921.64c49782.js","mappings":"opBA2CA,MAAMA,GAASC,EAAAA,EAAAA,MACTC,GAAQC,EAAAA,EAAAA,MACRC,GAASC,EAAAA,EAAAA,IAAI,IACbC,GAAWD,EAAAA,EAAAA,IAAI,IACfE,GAAMF,EAAAA,EAAAA,IAAI,IACVG,GAAMH,EAAAA,EAAAA,IAAI,IACVI,GAAWJ,EAAAA,EAAAA,IAAI,IACfK,GAAQL,EAAAA,EAAAA,IAAI,IACZM,GAAKN,EAAAA,EAAAA,IAAI,IACTO,GAASP,EAAAA,EAAAA,IAAI,IACbQ,GAASR,EAAAA,EAAAA,IAAI,IACbS,GAAWC,EAAAA,EAAAA,MACXC,EAAUF,GAAUG,WAAWC,OAAOC,iBAAiBC,SACvDC,EAAQC,EAId,SAASC,EAAaC,GACpB,MAAMC,EAAY,IAAIC,KAAKF,GACrBG,EAAc,IAAID,KACxB,IAAIE,EAAgBD,EAAYE,cAAgBJ,EAAUI,cAC1D,MAAMC,EAAYH,EAAYI,WAAaN,EAAUM,WAIrD,OAHID,EAAY,GAAoB,IAAdA,GAAmBH,EAAYK,UAAYP,EAAUO,YACzEJ,IAEKA,CACT,CAEA,SAASK,IACa,OAAjBZ,EAAMa,eAAkCC,IAAjBd,EAAMa,SAC9BE,EAAAA,EAAMC,IAAI,gCAAiC,CACzCC,aAAc,SACbC,MAAKC,IACN,MAAMC,EAAOD,EAAIC,KAAKA,KACtBrC,EAAOsC,MAAQD,EAAKE,WACpBrC,EAASoC,MAAQD,EAAKG,SACtBrC,EAAImC,MAAQD,EAAKlC,IACjBE,EAASiC,MAAQD,EAAKhC,SACtBC,EAAMgC,MAAQD,EAAK/B,MACnBC,EAAG+B,MAAQD,EAAK9B,GAChBC,EAAO8B,MAAQD,EAAK7B,OACpBC,EAAO6B,MAAQD,EAAK5B,OAEpBL,EAAIkC,MAAQnB,EAAad,EAASiC,MAAM,IACvCG,OAAMC,IACPC,QAAQC,IAAIF,EAAI,IAGlBV,EAAAA,EAAMC,IAAI,sCAAuC,CAC/CY,OAAO,CACLf,SAASb,EAAMa,UAEjBI,aAAc,SACbC,MAAKC,IACN,MAAMC,EAAOD,EAAIC,KAAKA,KACtBrC,EAAOsC,MAAQD,EAAKE,WACpBrC,EAASoC,MAAQD,EAAKG,SACtBrC,EAAImC,MAAQD,EAAKlC,IACjBE,EAASiC,MAAQD,EAAKhC,SACtBC,EAAMgC,MAAQD,EAAK/B,MACnBC,EAAG+B,MAAQD,EAAK9B,GAChBC,EAAO8B,MAAQD,EAAK7B,OACpBC,EAAO6B,MAAQD,EAAK5B,OAEpBL,EAAIkC,MAAQnB,EAAad,EAASiC,MAAM,IACvCG,OAAMC,IACPC,QAAQC,IAAIF,EAAI,GAGtB,CAEA,SAASI,EAAUhB,IACE,IAAhBlB,EAAQ0B,MACTN,EAAAA,EAAMC,IAAI,kCAAkC,CAC1CY,OAAO,CACLf,SAASA,KAEVK,MAAK,KACHY,QAAQ,kBACTnD,EAAOoD,KAAK,aAAa,IAC1BP,MAAME,QAAQC,KAEjBhD,EAAOoD,KAAK,SAEhB,C,OAEAC,EAAAA,EAAAA,KAAU,KACRpB,GAAa,KAIfqB,EAAAA,EAAAA,KAAY,KACV,MAAMC,EAAM,IAAI7B,KACV8B,EAAW,IAAI9B,KAAK6B,EAAI1B,cAAe0B,EAAIxB,WAAYwB,EAAIvB,UAAY,EAAG,EAAG,EAAG,GAChFyB,EAAoBD,EAAWD,EAErCG,YAAW,KACTlD,EAAIkC,MAAQnB,EAAad,EAASiC,OAElCiB,aAAY,KACVnD,EAAIkC,MAAQnB,EAAad,EAASiC,MAAM,GACvC,MAAoB,GACtBe,EAAkB,I,mtCC5IvB,MAAMG,EAAc,EAEpB,O","sources":["webpack://blog/./src/components/profile/personalInfo.vue","webpack://blog/./src/components/profile/personalInfo.vue?5edc"],"sourcesContent":["<template>\r\n  <div class=\"profile-content\">\r\n    <h1>个人资料</h1>\r\n    <div class=\"nickname\">\r\n      <el-avatar :src=\"avatar\" size=\"100\"></el-avatar>\r\n      <span>{{ nickname }}</span>\r\n    </div>\r\n    <div class=\"profile-item\">\r\n      <span>性别:</span>\r\n      <span class=\"profile-info\">{{ sex }}</span>\r\n    </div>\r\n    <div class=\"profile-item\">\r\n      <span>年龄:</span>\r\n      <span class=\"profile-info\">{{ age }}</span>\r\n      <span style=\"margin-left: 10px\">生日:</span>\r\n      <span style=\"margin-left: 10px\">{{ birthday }}</span>\r\n    </div>\r\n    <div class=\"profile-item\">\r\n      <span>电话:</span>\r\n      <span class=\"profile-info\">{{ phone }}</span>\r\n    </div>\r\n    <div class=\"profile-item\">\r\n      <span>QQ:</span>\r\n      <span class=\"profile-info\">{{ qq }}</span>\r\n    </div>\r\n    <div class=\"profile-item\">\r\n      <span>微信:</span>\r\n      <span class=\"profile-info\">{{ wechat }}</span>\r\n    </div>\r\n    <div class=\"profile-item\">\r\n      <span>毕业院校:</span>\r\n      <span class=\"profile-info\">{{ school }}</span>\r\n    </div>\r\n    <el-button v-if=\"route.path.slice(0,route.path.lastIndexOf('/'))==='userProfile'\" style=\"width: 100px\" @click=\"addFriend(username)\">添加好友</el-button>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { onMounted, ref, watchEffect } from \"vue\";\r\nimport axios from '@/axios';\r\nimport {getCurrentInstance} from \"vue\";\r\nimport {useRouter,useRoute} from \"vue-router\";\r\n\r\nconst router = useRouter();\r\nconst route = useRoute();\r\nconst avatar = ref('');\r\nconst nickname = ref('');\r\nconst sex = ref('');\r\nconst age = ref('');\r\nconst birthday = ref('');\r\nconst phone = ref('');\r\nconst qq = ref('');\r\nconst wechat = ref('');\r\nconst school = ref('');\r\nconst instance = getCurrentInstance();\r\nconst isLogin = instance?.appContext.config.globalProperties.$isLogin;\r\nconst props = defineProps({\r\n  username:String\r\n})\r\n// 计算年龄的函数\r\nfunction calculateAge(birthdayStr) {\r\n  const birthDate = new Date(birthdayStr);\r\n  const currentDate = new Date();\r\n  let calculatedAge = currentDate.getFullYear() - birthDate.getFullYear();\r\n  const monthDiff = currentDate.getMonth() - birthDate.getMonth();\r\n  if (monthDiff < 0 || (monthDiff === 0 && currentDate.getDate() < birthDate.getDate())) {\r\n    calculatedAge--;\r\n  }\r\n  return calculatedAge;\r\n}\r\n\r\nfunction initProfile() {\r\n  if(props.username===null||props.username===undefined){\r\n    axios.get(\"http://localhost:8081/profile\", {\r\n      responseType: \"json\"\r\n    }).then(res => {\r\n      const data = res.data.data;\r\n      avatar.value = data.avatar_src;\r\n      nickname.value = data.nikeName;\r\n      sex.value = data.sex;\r\n      birthday.value = data.birthday;\r\n      phone.value = data.phone;\r\n      qq.value = data.qq;\r\n      wechat.value = data.wechat;\r\n      school.value = data.school;\r\n      // 初始化年龄\r\n      age.value = calculateAge(birthday.value);\r\n    }).catch(err => {\r\n      console.log(err);\r\n    });\r\n  }else{\r\n    axios.get(\"http://localhost:8081/friendProfile\", {\r\n      params:{\r\n        username:props.username\r\n      },\r\n      responseType: \"json\"\r\n    }).then(res => {\r\n      const data = res.data.data;\r\n      avatar.value = data.avatar_src;\r\n      nickname.value = data.nikeName;\r\n      sex.value = data.sex;\r\n      birthday.value = data.birthday;\r\n      phone.value = data.phone;\r\n      qq.value = data.qq;\r\n      wechat.value = data.wechat;\r\n      school.value = data.school;\r\n      // 初始化年龄\r\n      age.value = calculateAge(birthday.value);\r\n    }).catch(err => {\r\n      console.log(err);\r\n    });\r\n  }\r\n}\r\n\r\nfunction addFriend(username){\r\n  if(isLogin.value===true){\r\n    axios.get(\"http://localhost:8081/addFriend\",{\r\n      params:{\r\n        username:username,\r\n      }\r\n    }).then(()=>{\r\n      if(confirm(\"添加成功！确认返回聊天界面\"))\r\n        router.push(\"/contactMe\")\r\n    }).catch(console.log)\r\n  }else {\r\n    router.push(\"/login\");\r\n  }\r\n}\r\n\r\nonMounted(() => {\r\n  initProfile();\r\n});\r\n\r\n// 每天更新一次年龄\r\nwatchEffect(() => {\r\n  const now = new Date();\r\n  const midnight = new Date(now.getFullYear(), now.getMonth(), now.getDate() + 1, 0, 0, 0);\r\n  const timeUntilMidnight = midnight - now;\r\n\r\n  setTimeout(() => {\r\n    age.value = calculateAge(birthday.value);\r\n    // 每天更新一次\r\n    setInterval(() => {\r\n      age.value = calculateAge(birthday.value);\r\n    }, 24 * 60 * 60 * 1000);\r\n  }, timeUntilMidnight);\r\n});\r\n</script>\r\n\r\n<style>\r\n.profile-content {\r\n  display: flex;\r\n  flex-direction: column;\r\n}\r\n\r\n.profile-item {\r\n  display: flex;\r\n  align-items: center;\r\n  margin-bottom: 15px;\r\n}\r\n\r\n.nickname {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-items: center;\r\n  font-size: 20px;\r\n  font-weight: bold;\r\n  margin-top: 10px;\r\n  margin-bottom: 10px;\r\n}\r\n.profile-info{\r\n  margin-left: 10px;\r\n}\r\n</style>","import script from \"./personalInfo.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./personalInfo.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./personalInfo.vue?vue&type=style&index=0&id=4d34f9cd&lang=css\"\n\nconst __exports__ = script;\n\nexport default __exports__"],"names":["router","useRouter","route","useRoute","avatar","ref","nickname","sex","age","birthday","phone","qq","wechat","school","instance","getCurrentInstance","isLogin","appContext","config","globalProperties","$isLogin","props","__props","calculateAge","birthdayStr","birthDate","Date","currentDate","calculatedAge","getFullYear","monthDiff","getMonth","getDate","initProfile","username","undefined","axios","get","responseType","then","res","data","value","avatar_src","nikeName","catch","err","console","log","params","addFriend","confirm","push","onMounted","watchEffect","now","midnight","timeUntilMidnight","setTimeout","setInterval","__exports__"],"sourceRoot":""}